<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 7 - Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --bg-blue: #e0f2fe;
            --accent-blue: #7dd3fc;
            --dark-blue: #0369a1;
            --pastel-red: #fca5a5;
            --pastel-green: #86efac;
            --text-gray: #334155;
        }

        body {
            font-family: 'Comic Sans MS', 'Segoe UI', cursive, sans-serif;
            background-color: var(--bg-blue);
            background-image: radial-gradient(var(--accent-blue) 0.5px, transparent 0.5px);
            background-size: 20px 20px;
            color: var(--text-gray);
            margin: 0; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.98);
            padding: 2.5rem; border-radius: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            max-width: 850px; width: 100%;
            border: 4px dashed var(--accent-blue);
            box-sizing: border-box;
        }

        h1 { color: var(--dark-blue); text-align: center; font-size: 2.5rem; margin-bottom: 30px; }
        h2 { border-bottom: 3px solid var(--bg-blue); padding-bottom: 5px; color: var(--dark-blue); margin-top: 2rem; }

        .task-description { font-weight: bold; margin-bottom: 15px; color: var(--dark-blue); font-size: 1.1rem; }

        .word-bank {
            background: #fff; border: 2px solid var(--accent-blue);
            padding: 15px; border-radius: 15px; margin: 15px 0;
            display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;
            box-shadow: 4px 4px 0px var(--accent-blue);
        }

        .bank-item {
            background: var(--bg-blue); padding: 5px 15px; border-radius: 10px;
            font-size: 1rem; border: 1px solid var(--accent-blue); font-weight: bold;
        }

        .question-block {
            background: #fff; padding: 25px; border-radius: 15px;
            margin-bottom: 20px; border: 1px solid #d1edff; line-height: 2.2;
        }

        .problem-text { color: #1e293b; font-weight: bold; display: block; margin-top: 15px; }
        .advice-text { color: var(--dark-blue); display: block; margin-bottom: 10px; }

        .input-gap {
            border: none; border-bottom: 2px solid var(--accent-blue);
            background: transparent; font-size: 1.1rem; font-weight: bold;
            color: var(--dark-blue); outline: none; text-align: center;
        }

        .btn-submit {
            display: block; width: 100%; padding: 18px;
            background: var(--dark-blue); color: white;
            border: none; border-radius: 50px; font-size: 1.3rem;
            font-weight: bold; cursor: pointer; margin-top: 2rem;
            box-shadow: 0 5px 0 #075985;
        }

        #results-area {
            display: none; text-align: center; margin-top: 2rem;
            padding: 30px; background: white; border-radius: 2rem;
            border: 5px solid var(--pastel-green); width: 100%; max-width: 850px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Unit 7 - Test üìù</h1>
    
    <div style="text-align: center; margin-bottom: 40px;">
        <label style="font-weight: bold;">Student Name: </label>
        <input type="text" id="student-name" class="input-gap" style="width: 300px;">
    </div>

    <h2>VOCABULARY</h2>
    <p class="task-description">Task 1 - Complete the sentences with be, do, have or make and one of these words:</p>
    <div class="word-bank">
        <span class="bank-item">arguments</span> <span class="bank-item">a problem</span> 
        <span class="bank-item">friends</span> <span class="bank-item">fun</span> 
        <span class="bank-item">lots in common</span> <span class="bank-item">me a favour</span> 
        <span class="bank-item">my fault</span> <span class="bank-item">on their own</span>
    </div>
    <div class="question-block">
        1 Could you <input type="text" class="q-input" style="width:150px" data-ans="do me a favour">? Could I use your mobile phone? <br>
        2 Everybody was very friendly at summer camp so it was easy to <input type="text" class="q-input" style="width:150px" data-ans="make friends">. <br>
        3 I always <input type="text" class="q-input" style="width:120px" data-ans="have fun"> when I‚Äôm with my cousins. We play cards or watch a film. <br>
        4 My best friend and I <input type="text" class="q-input" style="width:200px" data-ans="have lots in common">, we both love cycling. <br>
        5 Don‚Äôt speak! Put up your hand if you <input type="text" class="q-input" style="width:150px" data-ans="have a problem">. <br>
        6 I wasn‚Äôt there. It can‚Äôt <input type="text" class="q-input" style="width:130px" data-ans="be my fault"> that the window is broken. <br>
        7 My sister and I often <input type="text" class="q-input" style="width:160px" data-ans="have arguments"> about who should do the washing up. <br>
        8 Most people like to <input type="text" class="q-input" style="width:150px" data-ans="be on their own"> sometimes like when they‚Äôre studying.
    </div>

    <p class="task-description">Task 2 - Complete these sentences with a verb in the correct form from box A and a word from box B:</p>
    <div style="display:flex; justify-content: space-around; margin-bottom: 10px;">
        <div class="word-bank" style="width: 45%;"><strong>A:</strong> come, fall, get, hang, look, make, split</div>
        <div class="word-bank" style="width: 45%;"><strong>B:</strong> after, on, out, together, round, up</div>
    </div>
    <div class="question-block" id="task-2-block">
        1 When I forgot my friend‚Äôs birthday, we <input type="text" class="q-input t2-v" style="width:80px" data-ans="fell"> <input type="text" class="q-input t2-p" style="width:60px" data-ans="out"> and we didn‚Äôt speak to each other for weeks. <br>
        2 In the holidays, I <input type="text" class="q-input t2-v" style="width:80px" data-ans="get"> <input type="text" class="q-input t2-p" style="width:100px" data-ans="together"> with my friends every afternoon. <br>
        3 My dad <input type="text" class="q-input t2-v" style="width:80px" data-ans="gets"> <input type="text" class="q-input t2-p" style="width:50px" data-ans="on"> well with his brother because they‚Äôre both cheerful and funny. <br>
        4 My sister often argues with her best friend, but they always <input type="text" class="q-input t2-v" style="width:80px" data-ans="make"> <input type="text" class="q-input t2-p" style="width:50px" data-ans="up"> again soon afterwards. <br>
        5 My aunt and uncle often <input type="text" class="q-input t2-v" style="width:80px" data-ans="come"> <input type="text" class="q-input t2-p" style="width:80px" data-ans="round"> to visit my parents. <br>
        6 I don‚Äôt like the park because that‚Äôs where the younger kids <input type="text" class="q-input t2-v" style="width:80px" data-ans="hang"> <input type="text" class="q-input t2-p" style="width:50px" data-ans="out"> and ride their bikes. <br>
        7 My brother has <input type="text" class="q-input t2-v" style="width:80px" data-ans="split"> <input type="text" class="q-input t2-p" style="width:50px" data-ans="up"> with his girlfriend and they‚Äôre both feeling quite sad. <br>
        8 I sometimes <input type="text" class="q-input t2-v" style="width:80px" data-ans="look"> <input type="text" class="q-input t2-p" style="width:80px" data-ans="after"> our neighbour‚Äôs baby for an hour or two.
    </div>

    <h2>GRAMMAR</h2>
    <p class="task-description">Task 3 - Complete the sentences with the correct form of must or have to:</p>
    <div class="question-block">
        1 Stop! They‚Äôre doing an exam in there. You <input type="text" class="q-input" style="width:100px" data-ans="mustn't|mustn‚Äôt"> go in. <br>
        2 I can‚Äôt go out later. My mum says I <input type="text" class="q-input" style="width:130px" data-ans="have to|must"> study. <br>
        3 Dad can drive us. We <input type="text" class="q-input" style="width:150px" data-ans="don't have to|don‚Äôt have to"> go by public transport. <br>
        4 I <input type="text" class="q-input" style="width:150px" data-ans="don't have to|don‚Äôt have to"> go to school tomorrow. It‚Äôs a holiday. <br>
        5 It was Saturday afternoon and I <input type="text" class="q-input" style="width:150px" data-ans="didn't have to|didn‚Äôt have to"> get home until 9 pm. (not necessary) <br>
        6 The sign says ‚Äòno ball games‚Äô so you <input type="text" class="q-input" style="width:100px" data-ans="mustn't|mustn‚Äôt"> play football here. <br>
        7 When my mum was a child, she <input type="text" class="q-input" style="width:100px" data-ans="had to"> wear a school uniform. <br>
        8 What <input type="text" class="q-input" style="width:60px" data-ans="did"> we <input type="text" class="q-input" style="width:100px" data-ans="have to"> do for homework last night?
    </div>

    <p class="task-description">Task 4 - Read the problem and complete the advice with should or shouldn‚Äôt and one of these verbs:</p>
    <div class="word-bank">ask ; buy ; call ; do ; go ; join ; pack ; worry</div>
    <div class="question-block">
        <span class="problem-text">1 I lost my keys yesterday. My parents are going to be angry.</span>
        <span class="advice-text">You <input type="text" class="q-input" style="width:150px" data-ans="should ask"> our teacher if she‚Äôs got them.</span>
        
        <span class="problem-text">2 My brother‚Äôs got an important exam tomorrow but it‚Äôs his birthday today.</span>
        <span class="advice-text">He <input type="text" class="q-input" style="width:150px" data-ans="shouldn't go|shouldn‚Äôt go"> out late today. He can get together with his friends tomorrow.</span>
        
        <span class="problem-text">3 My best friend is quite shy and she‚Äôs going to summer camp.</span>
        <span class="advice-text">She <input type="text" class="q-input" style="width:150px" data-ans="shouldn't worry|shouldn‚Äôt worry">. She‚Äôll make friends easily.</span>
        
        <span class="problem-text">4 I‚Äôd like to try a new sport.</span>
        <span class="advice-text">You <input type="text" class="q-input" style="width:150px" data-ans="should join"> a sports centre and you can try new sports there.</span>
        
        <span class="problem-text">5 We don‚Äôt know what to buy mum for her birthday.</span>
        <span class="advice-text">You <input type="text" class="q-input" style="width:150px" data-ans="shouldn't buy|shouldn‚Äô—Ç buy"> her flowers ‚Äì she doesn‚Äôt like them.</span>
        
        <span class="problem-text">6 I‚Äôm hungry and there‚Äôs nothing to eat.</span>
        <span class="advice-text">You <input type="text" class="q-input" style="width:150px" data-ans="should call"> for a pizza. Here‚Äôs the number.</span>
        
        <span class="problem-text">7 My aunt and uncle are going to London next week.</span>
        <span class="advice-text">They <input type="text" class="q-input" style="width:150px" data-ans="should pack"> warm clothes. It‚Äôs going to be cold.</span>
        
        <span class="problem-text">8 My sister often goes into my room and lies on my bed.</span>
        <span class="advice-text">She <input type="text" class="q-input" style="width:150px" data-ans="shouldn't do|shouldn‚Äô—Ç do"> that! She should ask you first.</span>
    </div>

    <button class="btn-submit" onclick="gradeTest()">Finish & Check! ‚ú®</button>
</div>

<div id="results-area">
    <h2 id="final-score-display" style="color: var(--dark-blue);">Score: 0 / 33</h2>
    <p>Well done! Download your detailed report below:</p>
    <button class="btn-submit" style="background: #6366f1; box-shadow: 0 5px 0 #4338ca;" onclick="generatePDF()">Download Report PDF üìë</button>
</div>

<script>
    function gradeTest() {
        const name = document.getElementById('student-name').value;
        if (!name) return alert("Please enter your name first! üòä");

        let score = 0;
        document.querySelectorAll('.q-input').forEach(input => {
            const val = input.value.toLowerCase().trim();
            const correct = input.dataset.ans.toLowerCase().split('|');
            
            if (correct.includes(val)) {
                score++;
                input.style.backgroundColor = "var(--pastel-green)";
            } else {
                input.style.backgroundColor = "var(--pastel-red)";
            }
            input.disabled = true;
        });

        document.getElementById('results-area').style.display = 'block';
        document.getElementById('final-score-display').innerText = `Score: ${score} / 33`;
        window.scrollTo(0, document.body.scrollHeight);
    }

    function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const name = document.getElementById('student-name').value;
        const score = document.getElementById('final-score-display').innerText;

        doc.setFont("helvetica", "bold"); doc.text("Unit 7 Test Results", 20, 20);
        doc.setFontSize(12); doc.text(`Student: ${name}`, 20, 30);
        doc.text(score, 150, 30);
        doc.line(20, 35, 190, 35);

        let y = 45;
        const inputs = Array.from(document.querySelectorAll('.q-input'));

        // Handle Task 1, 3, 4
        inputs.forEach((input, index) => {
            if (input.classList.contains('t2-v') || input.classList.contains('t2-p')) return;
            
            if (y > 275) { doc.addPage(); y = 20; }
            const val = input.value || "(empty)";
            const correctOnes = input.dataset.ans.split('|');
            const isCorrect = correctOnes.map(a => a.toLowerCase()).includes(val.toLowerCase().trim());
            
            doc.setTextColor(isCorrect ? 0 : 180, isCorrect ? 100 : 80, isCorrect ? 0 : 80);
            let resultLine = `Q: ${val}`;
            if(!isCorrect) resultLine += ` (Correct: ${correctOnes[0]})`;
            doc.text(resultLine, 20, y);
            y += 8;
        });

        // Task 2 Sentences Reconstructed
        y += 5;
        doc.setTextColor(0,0,0); doc.text("Task 2 (Full Sentences):", 20, y); y += 10;
        
        const t2Items = [
            {pre: "1. When I forgot my friend's birthday, we ", post: " and we didn't speak for weeks.", v: "fell", p: "out"},
            {pre: "2. In the holidays, I ", post: " with my friends every afternoon.", v: "get", p: "together"},
            {pre: "3. My dad ", post: " well with his brother because they're both cheerful.", v: "gets", p: "on"},
            {pre: "4. My sister often argues, but they always ", post: " again soon afterwards.", v: "make", p: "up"},
            {pre: "5. My aunt and uncle often ", post: " to visit my parents.", v: "come", p: "round"},
            {pre: "6. That's where the younger kids ", post: " and ride their bikes.", v: "hang", p: "out"},
            {pre: "7. My brother has ", post: " with his girlfriend and they're both sad.", v: "split", p: "up"},
            {pre: "8. I sometimes ", post: " our neighbour's baby for an hour or two.", v: "look", p: "after"}
        ];

        const t2Inputs = Array.from(document.querySelectorAll('.t2-v, .t2-p'));
        for(let i=0; i<t2Items.length; i++) {
            if (y > 270) { doc.addPage(); y = 20; }
            const vVal = t2Inputs[i*2].value || "...";
            const pVal = t2Inputs[i*2+1].value || "...";
            const isCorrect = vVal.toLowerCase() === t2Items[i].v && pVal.toLowerCase() === t2Items[i].p;
            
            doc.setTextColor(isCorrect ? 0 : 180, isCorrect ? 100 : 80, 0);
            doc.text(`${t2Items[i].pre}${vVal} ${pVal}${t2Items[i].post}`, 20, y);
            if(!isCorrect) {
                y += 5; doc.setFontSize(9);
                doc.text(`(Correct: ...${t2Items[i].v} ${t2Items[i].p}...)`, 25, y);
                doc.setFontSize(11);
            }
            y += 10;
        }

        doc.save(`${name}_Unit7_Test.pdf`);
    }
</script>
</body>
</html>