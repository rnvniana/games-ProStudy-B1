<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Medical English Practice</title>
    <style>
        :root { 
            --primary: #0ea5e9; 
            --success: #10b981; 
            --error: #f43f5e; 
            --bg: #f0f9ff; 
            --dark: #0c4a6e;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; justify-content: center; color: #334155; }
        .card { background: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 4px 15px rgba(14, 165, 233, 0.1); max-width: 800px; width: 100%; border-top: 8px solid var(--primary); }
        
        h1, h2 { color: var(--dark); text-align: center; font-size: 1.5rem; }
        .score-box { position: sticky; top: 10px; background: var(--primary); color: white; padding: 12px; border-radius: 50px; text-align: center; font-weight: bold; z-index: 100; margin-bottom: 20px; }

        .reading-text { background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0; line-height: 1.6; margin-bottom: 25px; font-size: 0.95rem; }
        
        .tf-row { background: white; padding: 12px; border-radius: 10px; border: 1px solid #e0f2fe; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
        .btn-tf { padding: 8px 15px; border: 2px solid #bae6fd; background: white; border-radius: 8px; cursor: pointer; font-weight: bold; color: var(--primary); margin-left: 5px; }
        
        .btn-tf.selected-correct { background: var(--success) !important; color: white !important; border-color: var(--success) !important; }
        .btn-tf.selected-wrong { background: var(--error) !important; color: white !important; border-color: var(--error) !important; }
        .btn-tf.is-correct-answer { border: 2px solid var(--success); color: var(--success); }
        .btn-tf.not-selected { opacity: 0.4; }

        .writing-row { background: #f0f9ff; padding: 15px; border-radius: 12px; margin-bottom: 12px; border-left: 4px solid var(--primary); line-height: 2; }
        .input-gap { border: none; border-bottom: 2px solid var(--primary); background: transparent; padding: 2px 5px; font-size: 1rem; font-weight: bold; color: var(--dark); width: 130px; outline: none; text-align: center; }
        .input-gap.correct { color: var(--success); border-color: var(--success); }
        .input-gap.wrong { color: var(--error); border-color: var(--error); }

        #final-section { display: none; text-align: center; margin-top: 30px; padding: 20px; background: #e0f2fe; border-radius: 15px; }
        .save-btn { padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <div class="score-box">Score: <span id="score">0</span> / 140</div>
    
    <h1>A2 English for Medics ðŸ©º</h1>

    <h2>Task 1: True or False</h2>
    <div class="reading-text">
        Good language learners don't fear mistakes. They learn from them. They communicate in groups, take notes, and use dictionaries. Outside class, they think in English. It's about motivation and fun!
    </div>
    <div id="tf-container"></div>

    <h2>Task 2: Present Simple Writing</h2>
    <div id="writing-container"></div>

    <div id="final-section">
        <h3>Well Done! ðŸŽ“</h3>
        <input type="text" id="student-name" placeholder="Enter Name" style="padding:10px; border-radius:8px; border:1px solid var(--primary); width:60%;">
        <button class="save-btn" onclick="saveGame()">Save</button>
        <div id="lb" style="margin-top:20px; display:none;"><table id="lb-table" style="width:100%; border-collapse: collapse;"></table></div>
    </div>
</div>

<script>
    let score = 0;
    let tfCompleted = 0;
    let writingCompleted = 0;

    const tfQs = [
        { q: "1. Good language learners don't make mistakes.", a: "False" },
        { q: "2. It's a good idea to talk with other students.", a: "True" },
        { q: "3. Take notes only before an exam.", a: "False" },
        { q: "4. Good language learners write down words they learn.", a: "True" },
        { q: "5. Think of language when you are outside class.", a: "True" },
        { q: "6. Don't take tests outside of class.", a: "False" }
    ];

    const writeQs = [
        { id: 1, q: "1. What time ______ he ______ work? (START)", a: ["does", "start"] },
        { id: 2, q: "2. We ______ to the same place on holiday every year. (GO)", a: ["go"] },
        { id: 3, q: "3. My sister ______ chocolate. (NOT LIKE)", a: ["doesn't like"] },
        { id: 4, q: "4. ______ they ______ a lot of sport? (DO)", a: ["do", "do"] },
        { id: 5, q: "5. I ______ meals very often. (NOT COOK)", a: ["don't cook"] },
        { id: 6, q: "6. Why ______ cats ______ all the time? (SLEEP)", a: ["do", "sleep"] },
        { id: 7, q: "7. He ______ to different countries for work. (FLY)", a: ["flies"] },
        { id: 8, q: "8. ______ you ______ this question? (UNDERSTAND)", a: ["do", "understand"] }
    ];

    // Build Task 1
    const tfCont = document.getElementById('tf-container');
    tfQs.forEach((item, idx) => {
        const row = document.createElement('div');
        row.className = 'tf-row';
        row.innerHTML = `<span>${item.q}</span><div class="tf-btns"></div>`;
        const group = row.querySelector('.tf-btns');
        ["True", "False"].forEach(choice => {
            const btn = document.createElement('button');
            btn.className = 'btn-tf'; btn.innerText = choice;
            btn.onclick = () => {
                if (row.dataset.done) return;
                row.dataset.done = "true";
                if (choice === item.a) {
                    btn.classList.add('selected-correct');
                    score += 10;
                } else {
                    btn.classList.add('selected-wrong');
                    group.querySelectorAll('.btn-tf').forEach(b => { if(b.innerText === item.a) b.classList.add('is-correct-answer'); });
                }
                group.querySelectorAll('.btn-tf').forEach(b => { if(!b.classList.contains('selected-correct') && !b.classList.contains('selected-wrong')) b.classList.add('not-selected'); });
                tfCompleted++;
                updateProgress();
            };
            group.appendChild(btn);
        });
        tfCont.appendChild(row);
    });

    // Build Task 2
    const wCont = document.getElementById('writing-container');
    writeQs.forEach((item) => {
        const row = document.createElement('div');
        row.className = 'writing-row';
        let html = item.q;
        item.a.forEach((ans, i) => {
            html = html.replace("______", `<input type="text" class="input-gap q-${item.id}" data-ans="${ans}">`);
        });
        row.innerHTML = html;
        wCont.appendChild(row);

        const inputs = row.querySelectorAll('.input-gap');
        inputs.forEach(input => {
            input.oninput = () => {
                const userVal = input.value.toLowerCase().trim();
                const correctVal = input.dataset.ans.toLowerCase();
                
                if(userVal === correctVal){
                    input.classList.add('correct');
                    input.disabled = true;
                    score += 10;
                    document.getElementById('score').innerText = score;
                    
                    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾ Ð»Ð¸ Ð²ÑÑ‘ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
                    const rowInputs = row.querySelectorAll('.input-gap');
                    const allDone = Array.from(rowInputs).every(i => i.disabled);
                    if(allDone) {
                        writingCompleted++;
                        updateProgress();
                    }
                }
            };
            input.onblur = () => {
                if(input.value !== "" && !input.disabled) {
                    input.classList.add('wrong');
                    setTimeout(() => input.classList.remove('wrong'), 1000);
                }
            };
        });
    });

    function updateProgress() {
        document.getElementById('score').innerText = score;
        if (tfCompleted === 6 && writingCompleted === 8) {
            document.getElementById('final-section').style.display = 'block';
        }
    }

    function saveGame() {
        const name = document.getElementById('student-name').value || "Student";
        const results = JSON.parse(localStorage.getItem('med_final_v3') || '[]');
        results.push({name, score});
        results.sort((a,b) => b.score - a.score);
        localStorage.setItem('med_final_v3', JSON.stringify(results.slice(0,5)));
        document.getElementById('lb').style.display = 'block';
        document.getElementById('lb-table').innerHTML = results.map(r => `<tr><td style="padding:5px">${r.name}</td><td style="text-align:right"><b>${r.score}</b></td></tr>`).join('');
    }
</script>
</body>
</html>
