<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Reading Skill</title>
    <style>
        :root { 
            --primary: #f472b6; 
            --success: #34d399; 
            --error: #fb7185; 
            --bg: #fff1f2; 
        }
        body { font-family: 'Inter', sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; color: #4b5563; }
        .card { background: white; padding: 2rem; border-radius: 1.5rem; box-shadow: 0 10px 20px rgba(244, 114, 182, 0.1); max-width: 800px; width: 100%; border: 2px solid #fce7f3; }
        
        .text-section { display: grid; gap: 20px; margin-bottom: 40px; }
        .text-block { padding: 20px; border-radius: 15px; border: 2px solid #fdf2f8; }
        .text-block.kaitlin { background: #fffbeb; border-color: #fef3c7; }
        .text-block.dylan { background: #fdf2f8; border-color: #fce7f3; }
        .text-block.alex { background: #f0fdfa; border-color: #ccfbf1; }
        .badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-weight: bold; margin-bottom: 10px; font-size: 0.9rem; }
        .name-header { font-size: 1.2rem; font-weight: bold; color: #be185d; margin-bottom: 10px; }
        
        h2 { border-bottom: 3px solid var(--primary); display: inline-block; padding-bottom: 5px; color: #be185d; margin-top: 30px; }
        .question-row { background: #fffbff; padding: 15px; border-radius: 12px; border: 1px solid #fce7f3; margin-bottom: 10px; line-height: 1.6; }
        .btn-name { padding: 8px 14px; margin: 5px 4px; border: 2px solid #fbcfe8; background: white; cursor: pointer; border-radius: 10px; font-weight: 600; color: #be185d; }
        .btn-name.correct { background: var(--success); color: white; border-color: var(--success); }
        .btn-name.wrong { background: var(--error); color: white; border-color: var(--error); }

        .match-grid { display: grid; grid-template-columns: 1fr auto 1fr; gap: 10px; align-items: center; }
        .drop-zone { border-bottom: 2px dashed var(--primary); min-width: 120px; text-align: center; font-weight: bold; color: #be185d; min-height: 25px; cursor: pointer; }
        .drop-zone.filled { border: none; color: var(--success); border-bottom: 2px solid var(--success); }

        .words-bank { display: flex; flex-wrap: wrap; gap: 8px; background: #fdf2f8; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 2px dashed var(--primary); min-height: 40px; }
        .word-item { padding: 8px 12px; background: white; border: 2px solid var(--primary); border-radius: 8px; cursor: pointer; font-weight: 600; color: var(--primary); }
        
        .score-box { position: sticky; top: 10px; background: var(--primary); color: white; padding: 10px 20px; border-radius: 30px; text-align: center; font-weight: bold; z-index: 100; margin-bottom: 20px; }

        #final-section { display: none; text-align: center; margin-top: 30px; padding: 20px; background: #fdf2f8; border-radius: 20px; }
        .cat-img { width: 200px; border-radius: 20px; margin-bottom: 15px; border: 5px solid white; }
        input#player-name { padding: 10px; border-radius: 10px; border: 2px solid var(--primary); margin-bottom: 10px; width: 60%; }
        .btn-save { padding: 10px 25px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; }

        .leaderboard { margin-top: 30px; border-top: 2px solid #fce7f3; padding-top: 20px; display: none; }
        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: left; padding: 10px; border-bottom: 1px solid #fce7f3; }
    </style>
</head>
<body>

<div class="card">
    <div class="score-box">Score: <span id="total-score">0</span></div>
    
    <h1>Reading Skill Practice</h1>

    <div class="text-section">
        <div class="text-block kaitlin">
            <span class="badge" style="background:#fef3c7; color:#92400e;">1</span>
            <div class="name-header">KAITLIN</div>
            <p>I'm shy and haven't got many friends. Boys from my class were laughing at me because I was on my own. Why do I have to be with someone all the time?</p>
        </div>
        <div class="text-block dylan">
            <span class="badge" style="background:#fce7f3; color:#be185d;">2</span>
            <div class="name-header">DYLAN</div>
            <p>My brother read my diary! Then he took my phone and sent 50 texts. Now I have no credit. He is so annoying!</p>
        </div>
        <div class="text-block alex">
            <span class="badge" style="background:#f0fdfa; color:#0f766e;">3</span>
            <div class="name-header">ALEX</div>
            <p>My parents say I can't spend time with my mates because they can't trust me. It isn't fair! I don't want to fall out with them.</p>
        </div>
    </div>

    <h2>Task 1: Who is it?</h2>
    <div id="task1-container"></div>

    <h2>Task 2: Vocabulary Match</h2>
    <div class="words-bank" id="vocab-bank"></div>
    <div id="task2-container"></div>

    <div id="final-section">
        <img src="https://cataas.com/cat/says/Great%20Job!" alt="Cat" class="cat-img">
        <h3>"Excellent work, my friend!"</h3>
        <input type="text" id="player-name" placeholder="Type your name...">
        <br>
        <button class="btn-save" onclick="saveResult()">Save Score</button>
    </div>

    <div class="leaderboard" id="lb-section">
        <h3>üèÜ Score History</h3>
        <table>
            <thead><tr><th>Name</th><th>Score</th></tr></thead>
            <tbody id="lb-body"></tbody>
        </table>
    </div>
</div>

<script>
    let totalScore = 0;
    let completedCount = 0;
    const scoreEl = document.getElementById('total-score');

    const namesData = [
        { q: "1. ...has a problem as a result of a mistake.", ans: "Alex" },
        { q: "2. ...had a problem after class one day.", ans: "Kaitlin" },
        { q: "3. ...had an unwelcome visitor.", ans: "Dylan" },
        { q: "4. ...likes being alone sometimes.", ans: "Kaitlin" },
        { q: "5. ...doesn't agree with someone else's decision.", ans: "Alex" },
        { q: "6. ...can't use something essential.", ans: "Dylan" }
    ];

    const vocabData = [
        { def: "1. a secret word that protects you", word: "password" },
        { def: "2. shut something with a key", word: "lock" },
        { def: "3. say sorry to someone", word: "apologise" },
        { def: "4. treating people in a way that is right", word: "fair" },
        { def: "5. be polite and do the right things", word: "behave themselves" },
        { def: "6. believe someone is good and honest", word: "trust" }
    ];

    // Build Task 1
    const t1Cont = document.getElementById('task1-container');
    namesData.forEach((item) => {
        const row = document.createElement('div');
        row.className = 'question-row';
        row.innerHTML = `<div>${item.q}</div><div class="btns"></div>`;
        const btnArea = row.querySelector('.btns');
        ["Kaitlin", "Dylan", "Alex"].forEach(n => {
            const btn = document.createElement('button');
            btn.className = 'btn-name'; btn.innerText = n;
            btn.onclick = () => {
                if(row.dataset.done) return;
                if(n === item.ans) {
                    btn.classList.add('correct'); row.dataset.done = "true";
                    totalScore += 10; completedCount++; checkWin();
                } else {
                    btn.classList.add('wrong'); setTimeout(() => btn.classList.remove('wrong'), 500);
                    totalScore = Math.max(0, totalScore - 2);
                }
                scoreEl.innerText = totalScore;
            };
            btnArea.appendChild(btn);
        });
        t1Cont.appendChild(row);
    });

    // Build Task 2
    let selectedWord = null;
    let selectedElem = null;
    const bankCont = document.getElementById('vocab-bank');
    [...vocabData].map(x => x.word).sort(() => Math.random() - 0.5).forEach(w => {
        const div = document.createElement('div');
        div.className = 'word-item'; div.innerText = w;
        div.onclick = () => {
            document.querySelectorAll('.word-item').forEach(i => i.style.background = 'white');
            div.style.background = '#fbcfe8';
            selectedWord = w; selectedElem = div;
        };
        bankCont.appendChild(div);
    });

    const t2Cont = document.getElementById('task2-container');
    vocabData.forEach((item) => {
        const row = document.createElement('div');
        row.className = 'question-row';
        row.innerHTML = `<div class="match-grid"><span>${item.def}</span><span>‚ûî</span><span class="drop-zone" data-ans="${item.word}">?</span></div>`;
        row.querySelector('.drop-zone').onclick = function() {
            if(!selectedWord || this.classList.contains('filled')) return;
            if(selectedWord === this.dataset.ans) {
                this.innerText = selectedWord; this.classList.add('filled');
                selectedElem.style.display = 'none';
                totalScore += 15; completedCount++; checkWin();
                selectedWord = null;
            } else {
                this.innerText = "‚ùå"; setTimeout(() => { if(!this.classList.contains('filled')) this.innerText = "?"; }, 600);
                totalScore = Math.max(0, totalScore - 5);
            }
            scoreEl.innerText = totalScore;
        };
        t2Cont.appendChild(row);
    });

    function checkWin() {
        if(completedCount === 12) document.getElementById('final-section').style.display = 'block';
    }

    function saveResult() {
        const name = document.getElementById('player-name').value || "Star";
        const results = JSON.parse(localStorage.getItem('reading_results_v2') || '[]');
        results.push({ name, score: totalScore });
        results.sort((a,b) => b.score - a.score);
        localStorage.setItem('reading_results_v2', JSON.stringify(results.slice(0, 5)));
        showLB();
        document.getElementById('final-section').innerHTML = "<h3>Saved! Well done!</h3>";
    }

    function showLB() {
        const results = JSON.parse(localStorage.getItem('reading_results_v2') || '[]');
        document.getElementById('lb-section').style.display = 'block';
        document.getElementById('lb-body').innerHTML = results.map(r => `<tr><td>${r.name}</td><td>${r.score}</td></tr>`).join('');
    }
</script>
</body>
</html>